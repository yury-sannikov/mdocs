footer.footer.bg-black
  .container
    p
      | Copyright Â© #{moment().format('YYYY')}&nbsp;
      //- img.hidden-xs(src='/favicon.png', width='50px')
      | &nbsp;#{application}, all rights reserved. |&nbsp;
      a(href='/app/terms') Terms of Use&nbsp;
      | |&nbsp;
      a(href='/app/privacy') Privacy Policy

//- Load jQuery, food for thought:
//- https://palant.de/2014/06/30/please-don-t-use-externally-hosted-javascript-libraries
script(src='/app/lib/jquery/dist/jquery.min.js')
script(src='/app/lib/jquery-validation/dist/jquery.validate.min.js')
//- Then use jQuery to async load everything else
script.
  $(document).ready(function() {
    //- Async load main project js
    $.ajax({
      type: 'GET',
      url: '/app/js/#{application}.min.js',
      dataType: 'script',
      cache: true
    }).done(function () {
      window.addEventListener('load', function() {
        FastClick.attach(document.body);
      }, false);
    });
    $.validator.setDefaults({
      highlight: function(element) {
          $(element).closest('.form-group').addClass('has-error');
      },
      unhighlight: function(element) {
          $(element).closest('.form-group').removeClass('has-error');
      },
      errorElement: 'span',
      errorClass: 'help-block',
      errorPlacement: function(error, element) {
        if(element.parent('.input-group').length) {
          error.insertAfter(element.parent());
        } else {
          error.insertAfter(element);
        }
      }
    });
    //- Async load socket.io
    // $.ajax({
    //   type: 'GET',
    //   url: '//cdn.socket.io/socket.io-1.2.1.js',
    //   dataType: 'script',
    //   cache: true
    // }).done(function () {
    //   $(function(){
    //     var socket = io(window.location.hostname);
    //     socket.on('connect', function () {
    //       socket.emit('pageview', window.location.href);
    //     });
    //     window.onhashchange = function () {
    //       socket.emit('pageview', window.location.href);
    //     };
    //   });
    // });
  });
